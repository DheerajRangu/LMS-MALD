<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Istruzione F - Intelligent LMS</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }

        :root {
            --primary-color: #007AFF;
            --secondary-color: #5856D6;
            --accent-color: #00C7BE;
            --text-primary: #1D1D1F;
            --text-secondary: #86868B;
            --background: #FFFFFF;
            --background-secondary: #F5F5F7;
            --gradient: linear-gradient(135deg, #007AFF 0%, #5856D6 50%, #00C7BE 100%);
            --gradient-soft: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --grok-green: #00ff88;
            --assistant-bg: #f7f7f8;
            --user-bg: #007AFF;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', 'Helvetica Neue', sans-serif;
            -webkit-font-smoothing: antialiased;
            background-color: var(--background);
            color: var(--text-primary);
            overflow-x: hidden;
            scroll-behavior: smooth;
        }

        /* --- SPLASH SCREEN & LOGO --- */
        .splash-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100vh;
            background: var(--gradient-soft); display: flex; justify-content: center; align-items: center;
            z-index: 1000; animation: fadeOut 0.5s ease-in-out 2.5s forwards;
        }
        .splash-content { text-align: center; animation: float 2s ease-in-out infinite; }
        
        .dinosaur-logo { margin: 0 auto 2rem; width: 120px; height: 100px; position: relative; }
        .dino-body { position: relative; width: 80px; height: 40px; background: linear-gradient(135deg, var(--grok-green), var(--primary-color)); border-radius: 20px 20px 8px 8px; margin: 0 auto; }
        .dino-head { position: absolute; top: -15px; left: 60px; width: 30px; height: 25px; background: linear-gradient(135deg, var(--grok-green), var(--primary-color)); border-radius: 50% 50% 40% 40%; animation: headBob 2s ease-in-out infinite; }
        .dino-eye { position: absolute; top: 8px; right: 8px; width: 6px; height: 6px; background: white; border-radius: 50%; }
        .dino-neck { position: absolute; top: 5px; left: -10px; width: 15px; height: 15px; background: linear-gradient(135deg, var(--grok-green), var(--primary-color)); border-radius: 50%; }
        .dino-back { position: absolute; top: -5px; left: 20px; width: 20px; height: 15px; background: linear-gradient(135deg, var(--primary-color), var(--secondary-color)); border-radius: 30% 40% 40% 30%; }
        .dino-tail { position: absolute; top: 10px; left: -15px; width: 20px; height: 8px; background: linear-gradient(135deg, var(--secondary-color), var(--primary-color)); border-radius: 50% 0 0 50%; animation: tailWag 1s ease-in-out infinite; }
        .dino-leg { position: absolute; bottom: -10px; width: 8px; height: 15px; background: var(--primary-color); border-radius: 4px; }
        .front-leg { left: 20px; animation: legMove 0.6s ease-in-out infinite; }
        .back-leg { left: 50px; animation: legMove 0.6s ease-in-out infinite 0.3s; }

        .logo-text h1 { font-size: 3.5rem; font-weight: 700; color: white; margin-bottom: 0.5rem; }
        .f-accent { color: var(--grok-green); font-style: italic; margin-left: 4px; }
        .tagline { color: rgba(255, 255, 255, 0.8); font-size: 1.1rem; letter-spacing: 0.5px; }

        .loading-dots { display: flex; justify-content: center; gap: 8px; margin-top: 2rem; }
        .dot { width: 8px; height: 8px; background: rgba(255, 255, 255, 0.6); border-radius: 50%; animation: dotPulse 1.4s ease-in-out infinite both; }
        .dot:nth-child(2) { animation-delay: 0.2s; }
        .dot:nth-child(3) { animation-delay: 0.4s; }

        /* --- LAYOUT --- */
        .main-content { opacity: 0; animation: fadeIn 0.8s ease-in-out forwards; }
        .header { position: fixed; top: 0; width: 100%; background: rgba(255, 255, 255, 0.8); backdrop-filter: blur(20px); border-bottom: 1px solid rgba(0, 0, 0, 0.1); z-index: 100; }
        .header-content { max-width: 1200px; margin: 0 auto; padding: 1rem 2rem; display: flex; justify-content: space-between; align-items: center; }
        .nav-logo { display: flex; align-items: center; gap: 0.75rem; font-size: 1.5rem; font-weight: 700; color: var(--text-primary); }
        .mini-dino { width: 24px; height: 16px; background: var(--gradient); border-radius: 4px; position: relative; }
        .mini-dino::before { content: ''; position: absolute; top: -4px; right: -4px; width: 12px; height: 8px; background: var(--gradient); border-radius: 50%; }
        .nav-menu { display: flex; align-items: center; gap: 2rem; }
        .nav-menu a { text-decoration: none; color: var(--text-secondary); font-weight: 500; transition: color 0.3s ease; }
        .nav-menu a:hover { color: var(--primary-color); }
        .nav-button { background: var(--gradient); color: white; border: none; padding: 0.75rem 1.5rem; border-radius: 12px; font-weight: 600; cursor: pointer; transition: transform 0.3s ease; }
        .nav-button:hover { transform: translateY(-2px); }

        /* --- HERO --- */
        .hero { padding: 120px 2rem 80px; max-width: 1200px; margin: 0 auto; }
        .hero-content { display: grid; grid-template-columns: 1fr 1fr; gap: 4rem; align-items: center; }
        .hero-text h1 { font-size: 3.5rem; font-weight: 700; line-height: 1.1; margin-bottom: 1.5rem; }
        .gradient-text { background: var(--gradient); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text; }
        .hero-text p { font-size: 1.25rem; color: var(--text-secondary); line-height: 1.6; margin-bottom: 2.5rem; }
        .hero-buttons { display: flex; gap: 1rem; margin-bottom: 3rem; }
        .btn { display: flex; align-items: center; gap: 0.5rem; padding: 1rem 2rem; border: none; border-radius: 14px; font-size: 1.1rem; font-weight: 600; cursor: pointer; transition: all 0.3s ease; }
        .btn-primary { background: var(--gradient); color: white; }
        .btn-primary:hover { transform: translateY(-2px); box-shadow: 0 10px 30px rgba(0, 122, 255, 0.3); }
        .btn-secondary { background: var(--background-secondary); color: var(--text-primary); }
        .btn-secondary:hover { background: #e5e5e7; transform: translateY(-2px); }
        
        .hero-stats { display: flex; gap: 2rem; }
        .stat { text-align: center; }
        .stat-number { font-size: 1.5rem; font-weight: 700; color: var(--primary-color); margin-bottom: 0.25rem; }
        .stat-label { font-size: 0.9rem; color: var(--text-secondary); }

        .hero-visual { position: relative; height: 400px; display: flex; justify-content: center; align-items: center; }
        .ai-orb { width: 200px; height: 200px; background: var(--gradient); border-radius: 50%; filter: blur(40px); opacity: 0.3; animation: pulse 4s ease-in-out infinite; }
        .floating-card { position: absolute; background: rgba(255, 255, 255, 0.9); backdrop-filter: blur(20px); border: 1px solid rgba(255, 255, 255, 0.2); border-radius: 16px; padding: 1rem 1.5rem; display: flex; align-items: center; gap: 0.75rem; font-weight: 600; box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1); animation: float 3s ease-in-out infinite; }
        .card-1 { top: 20%; left: 10%; animation-delay: 0s; }
        .card-2 { top: 60%; right: 10%; animation-delay: 1s; }
        .card-3 { bottom: 20%; left: 20%; animation-delay: 2s; }
        .card-icon { font-size: 1.25rem; }

        /* --- FEATURES --- */
        .features { padding: 80px 2rem; background: var(--background-secondary); }
        .container { max-width: 1200px; margin: 0 auto; }
        .features h2 { text-align: center; font-size: 2.5rem; font-weight: 700; margin-bottom: 3rem; color: var(--text-primary); }
        .features-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 2rem; }
        .feature-card { background: white; padding: 2.5rem 2rem; border-radius: 20px; text-align: center; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08); transition: transform 0.3s ease, box-shadow 0.3s ease; }
        .feature-card:hover { transform: translateY(-8px); box-shadow: 0 12px 40px rgba(0, 0, 0, 0.15); }
        .feature-icon { font-size: 3rem; margin-bottom: 1.5rem; }
        .feature-card h3 { font-size: 1.5rem; font-weight: 600; margin-bottom: 1rem; color: var(--text-primary); }
        .feature-card p { color: var(--text-secondary); line-height: 1.6; }

        /* --- TOMMY SECTION --- */
        .tommy-section { padding: 80px 2rem; background: var(--background); }
        .tommy-content { display: grid; grid-template-columns: 1fr 1fr; gap: 4rem; align-items: center; }
        .tommy-visual { display: flex; justify-content: center; align-items: center; }
        .tommy-avatar { width: 300px; height: 300px; background: var(--gradient); border-radius: 50%; display: flex; justify-content: center; align-items: center; position: relative; animation: pulse 3s ease-in-out infinite; }
        .tommy-avatar::before { content: 'ü§ñ'; font-size: 5rem; }
        .tommy-avatar::after { content: ''; position: absolute; width: 320px; height: 320px; border: 2px solid var(--primary-color); border-radius: 50%; animation: rotate 10s linear infinite; }
        .tommy-features { display: flex; flex-direction: column; gap: 1.5rem; }
        .tommy-feature { display: flex; align-items: center; gap: 1rem; padding: 1.5rem; background: var(--background-secondary); border-radius: 16px; transition: transform 0.3s ease; }
        .tommy-feature:hover { transform: translateX(10px); }
        .tommy-feature-icon { font-size: 2rem; width: 60px; height: 60px; background: var(--gradient); border-radius: 50%; display: flex; justify-content: center; align-items: center; }

        /* --- ADVANCED CHATBOT WIDGET (UPDATED) --- */
        .chatbot-widget { position: fixed; bottom: 30px; right: 30px; width: 60px; height: 60px; background: var(--gradient); border-radius: 50%; display: flex; justify-content: center; align-items: center; cursor: pointer; box-shadow: 0 4px 20px rgba(0, 0, 0, 0.2); z-index: 1000; transition: transform 0.3s ease; color: white; font-size: 1.5rem; }
        .chatbot-widget:hover { transform: scale(1.1); }
        
        .chatbot-container { position: fixed; bottom: 100px; right: 30px; width: 400px; height: 600px; background: white; border-radius: 12px; box-shadow: 0 20px 60px rgba(0, 0, 0, 0.2); z-index: 1000; display: none; flex-direction: column; overflow: hidden; border: 1px solid #e5e5e5; }
        .chatbot-container.active { display: flex; }

        .chatbot-header { padding: 1rem; border-bottom: 1px solid #e5e5e5; display: flex; align-items: center; gap: 1rem; background: white; }
        .chatbot-avatar-small { width: 32px; height: 32px; background: var(--gradient); border-radius: 6px; display: flex; justify-content: center; align-items: center; font-size: 1rem; color: white; }
        .chatbot-info h3 { font-size: 1rem; margin-bottom: 0.1rem; font-weight: 600; }
        .chatbot-info p { font-size: 0.75rem; opacity: 0.7; }
        
        /* New Header Actions */
        .header-actions { margin-left: auto; display: flex; gap: 8px; }
        .icon-btn { background: none; border: none; cursor: pointer; font-size: 1.1rem; padding: 4px; border-radius: 4px; transition: background 0.2s; color: var(--text-secondary); }
        .icon-btn:hover { background: #f0f0f0; }
        .icon-btn.active { color: var(--primary-color); }

        .chatbot-messages { flex: 1; padding: 1rem; overflow-y: auto; display: flex; flex-direction: column; gap: 1rem; background: var(--assistant-bg); }
        .message { max-width: 85%; padding: 0.75rem 1rem; border-radius: 12px; font-size: 0.9rem; line-height: 1.5; }
        .message-bot { background: white; align-self: flex-start; border: 1px solid #e5e5e5; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .message-user { background: var(--user-bg); color: white; align-self: flex-end; }
        
        /* Rich Text Styles inside Message */
        .message strong { font-weight: 700; color: inherit; }
        .message ul { padding-left: 20px; margin-top: 5px; }
        .message li { margin-bottom: 4px; }
        
        .typing-indicator { display: flex; gap: 4px; padding: 12px 16px; background: white; border-radius: 12px; border: 1px solid #e5e5e5; align-self: flex-start; max-width: 60px; }
        .typing-dot { width: 6px; height: 6px; background: var(--text-secondary); border-radius: 50%; animation: typingPulse 1.4s ease-in-out infinite both; }
        .typing-dot:nth-child(2) { animation-delay: 0.2s; }
        .typing-dot:nth-child(3) { animation-delay: 0.4s; }

        .chatbot-input-container { padding: 1rem; border-top: 1px solid #e5e5e5; background: white; }
        .chatbot-input { display: flex; gap: 0.5rem; align-items: flex-end; }
        
        /* Lead Mode Styles */
        .input-mode-lead { border: 2px solid var(--accent-color) !important; }
        .btn-mode-lead { background: var(--accent-color) !important; }

        .chatbot-input textarea { flex: 1; padding: 0.75rem; border: 1px solid #e5e5e5; border-radius: 12px; outline: none; font-size: 0.9rem; font-family: inherit; resize: none; min-height: 40px; max-height: 120px; }
        .chatbot-input button { background: var(--primary-color); color: white; border: none; width: 40px; height: 40px; border-radius: 8px; cursor: pointer; display: flex; justify-content: center; align-items: center; transition: background 0.3s ease; }
        .chatbot-input button:hover { background: var(--secondary-color); }
        .chatbot-input button:disabled { background: var(--text-secondary); cursor: not-allowed; }

        .footer { padding: 2rem; text-align: center; background: var(--background-secondary); color: var(--text-secondary); }

        /* Animations */
        @keyframes fadeOut { to { opacity: 0; visibility: hidden; } }
        @keyframes fadeIn { to { opacity: 1; } }
        @keyframes float { 0%, 100% { transform: translateY(0px); } 50% { transform: translateY(-20px); } }
        @keyframes headBob { 0%, 100% { transform: rotate(0deg); } 50% { transform: rotate(5deg); } }
        @keyframes tailWag { 0%, 100% { transform: translateX(0) rotate(0deg); } 50% { transform: translateX(-3px) rotate(-5deg); } }
        @keyframes legMove { 0%, 100% { transform: translateY(0px); } 50% { transform: translateY(-5px); } }
        @keyframes dotPulse { 0%, 80%, 100% { transform: scale(0.8); opacity: 0.5; } 40% { transform: scale(1); opacity: 1; } }
        @keyframes typingPulse { 0%, 60%, 100% { transform: scale(1); opacity: 0.5; } 30% { transform: scale(1.2); opacity: 1; } }
        @keyframes pulse { 0%, 100% { transform: scale(1); opacity: 0.3; } 50% { transform: scale(1.1); opacity: 0.4; } }
        @keyframes rotate { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

        /* Responsive */
        @media (max-width: 768px) {
            .hero-content { grid-template-columns: 1fr; text-align: center; gap: 2rem; }
            .hero-text h1 { font-size: 2.5rem; }
            .hero-buttons { flex-direction: column; align-items: center; }
            .btn { width: 200px; justify-content: center; }
            .hero-stats { justify-content: center; }
            .nav-menu { display: none; }
            .features-grid { grid-template-columns: 1fr; }
            .tommy-content { grid-template-columns: 1fr; gap: 2rem; }
            .chatbot-container { width: calc(100vw - 40px); height: 70vh; right: 20px; bottom: 80px; left: 20px; }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // Navigation function
        const navigateToRolePage = () => {
            window.location.href = 'role.html';
        };

       // --- üß† REAL AI BRAIN (Connected to Server) ---
        const tommyBrain = {
            // Context tracking
            context: {},

            // Lead Gen Validation Logic
            handleLeadCapture: (input) => {
                const phoneRegex = /^[0-9\-\+\s\(\)]{8,}$/;
                if (phoneRegex.test(input)) {
                    return {
                        text: "Perfect! üåü We have received your number (**" + input + "**). A specialist is reviewing your profile now and will call you shortly.",
                        success: true
                    };
                } else {
                    return {
                        text: "That doesn't look like a valid phone number. Please try again (e.g. 555-0123).",
                        success: false
                    };
                }
            },

            // ‚ö° UPDATED: Talk to Port 3000
            generateResponse: async function(input) {
                try {
                    const response = await fetch('http://localhost:5000/api/chat', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                        },
                        body: JSON.stringify({ 
                            message: input, 
                            userId: "student_user_1" 
                        }) 
                    });

                    const data = await response.json();
                    
                    if (!response.ok) {
                        throw new Error("Server error");
                    }

                    // Check for action keywords
                    let action = null;
                    const lowerRes = data.response ? data.response.toLowerCase() : "";
                    if (lowerRes.includes("scroll") || lowerRes.includes("features")) {
                        action = "SCROLL_FEATURES";
                    }

                    return { 
                        text: data.response, 
                        action: action 
                    };

                } catch (error) {
                    console.error("Connection Error:", error);
                    return { 
                        text: "‚ö†Ô∏è **Brain Freeze!** I cannot reach the server on port 5000. Is it running?", 
                        action: null 
                    };
                }
            }
        }; // <-- Removed extra closing brace here

        // --- üé® RICH TEXT COMPONENT ---
        const MessageText = ({ text }) => {
            if (!text) return null;
            
            // Helper to parse **bold**
            const parseBold = (str) => {
                const parts = str.split(/(\*\*.*?\*\*)/g);
                return parts.map((part, i) => {
                    if (part.startsWith('**') && part.endsWith('**')) {
                        return React.createElement('strong', { key: i }, part.slice(2, -2));
                    }
                    return part;
                });
            };

            // Handle Lists (newlines with dots or dashes)
            const lines = text.split('\n');
            const formatted = lines.map((line, i) => {
                if (line.trim().startsWith('‚Ä¢') || line.trim().startsWith('-')) {
                    return React.createElement('li', { key: i }, parseBold(line.replace(/^[‚Ä¢-]\s*/, '')));
                }
                // Handle empty lines or standard text
                if (line.trim() === '') return React.createElement('br', { key: i });
                return React.createElement('div', { key: i }, parseBold(line));
            });

            return React.createElement('div', null, formatted);
        };

        // --- APP COMPONENTS ---

        const SplashScreen = () => {
            return React.createElement('div', { className: 'splash-screen' },
                React.createElement('div', { className: 'splash-content' },
                    React.createElement('div', { className: 'dinosaur-logo' },
                        React.createElement('div', { className: 'dino-body' },
                            React.createElement('div', { className: 'dino-head' },
                                React.createElement('div', { className: 'dino-eye' })
                            ),
                            React.createElement('div', { className: 'dino-neck' }),
                            React.createElement('div', { className: 'dino-back' }),
                            React.createElement('div', { className: 'dino-tail' }),
                            React.createElement('div', { className: 'dino-leg front-leg' }),
                            React.createElement('div', { className: 'dino-leg back-leg' })
                        )
                    ),
                    React.createElement('div', { className: 'logo-text' },
                        React.createElement('h1', null, 
                            'Istruzione',
                            React.createElement('span', { className: 'f-accent' }, 'F')
                        ),
                        React.createElement('p', { className: 'tagline' }, 'Advanced Learning Platform')
                    ),
                    React.createElement('div', { className: 'loading-dots' },
                        React.createElement('div', { className: 'dot' }),
                        React.createElement('div', { className: 'dot' }),
                        React.createElement('div', { className: 'dot' })
                    )
                )
            );
        };

        const Header = () => {
            return React.createElement('header', { className: 'header' },
                React.createElement('div', { className: 'header-content' },
                    React.createElement('div', { className: 'nav-logo' },
                        React.createElement('div', { className: 'mini-dino' }),
                        React.createElement('span', null, 
                            'Istruzione',
                            React.createElement('span', { className: 'f-accent' }, 'F')
                        )
                    ),
                    React.createElement('nav', { className: 'nav-menu' },
                        React.createElement('a', { href: '#features' }, 'Features'),
                        React.createElement('a', { href: '#tommy' }, 'Tommy Assistant'),
                        React.createElement('a', { href: '#pricing' }, 'Pricing'),
                        React.createElement('button', { 
                            className: 'nav-button',
                            onClick: navigateToRolePage
                        }, 'Get Started')
                    )
                )
            );
        };

        const Hero = () => {
            const scrollToFeatures = () => {
                const element = document.getElementById('features');
                if (element) {
                    element.scrollIntoView({ behavior: 'smooth' });
                }
            };

            return React.createElement('section', { className: 'hero' },
                React.createElement('div', { className: 'hero-content' },
                    React.createElement('div', { className: 'hero-text' },
                        React.createElement('h1', null, 
                            'The Future of Learning is ',
                            React.createElement('span', { className: 'gradient-text' }, 'Here')
                        ),
                        React.createElement('p', null, 
                            'Experience education transformed by advanced technology. Istruzione F combines ' +
                            'cutting-edge learning tools with intuitive design to create personalized learning ' +
                            'journeys that adapt to your unique style and goals.'
                        ),
                        React.createElement('div', { className: 'hero-buttons' },
                            React.createElement('button', { 
                                className: 'btn btn-primary',
                                onClick: navigateToRolePage
                            },
                                React.createElement('span', null, 'Start Learning'),
                                React.createElement('svg', { width: '20', height: '20', viewBox: '0 0 24 24', fill: 'none' },
                                    React.createElement('path', { 
                                        d: 'M5 12H19M19 12L12 5M19 12L12 19', 
                                        stroke: 'currentColor', 
                                        strokeWidth: '2' 
                                    })
                                )
                            ),
                            React.createElement('button', { 
                                className: 'btn btn-secondary',
                                onClick: scrollToFeatures
                            }, 'How It Works')
                        ),
                        React.createElement('div', { className: 'hero-stats' },
                            React.createElement('div', { className: 'stat' },
                                React.createElement('div', { className: 'stat-number' }, '50K+'),
                                React.createElement('div', { className: 'stat-label' }, 'Active Learners')
                            ),
                            React.createElement('div', { className: 'stat' },
                                React.createElement('div', { className: 'stat-number' }, '98%'),
                                React.createElement('div', { className: 'stat-label' }, 'Success Rate')
                            ),
                            React.createElement('div', { className: 'stat' },
                                React.createElement('div', { className: 'stat-number' }, '24/7'),
                                React.createElement('div', { className: 'stat-label' }, 'AI Support')
                            )
                        )
                    ),
                    React.createElement('div', { className: 'hero-visual' },
                        React.createElement('div', { className: 'ai-orb' }),
                        React.createElement('div', { className: 'floating-card card-1' },
                            React.createElement('div', { className: 'card-icon' }, 'ü§ñ'),
                            React.createElement('span', null, 'Smart Assistant')
                        ),
                        React.createElement('div', { className: 'floating-card card-2' },
                            React.createElement('div', { className: 'card-icon' }, '‚ö°'),
                            React.createElement('span', null, 'Fast Learning')
                        ),
                        React.createElement('div', { className: 'floating-card card-3' },
                            React.createElement('div', { className: 'card-icon' }, 'üéØ'),
                            React.createElement('span', null, 'Precise Goals')
                        )
                    )
                )
            );
        };

        const Features = () => {
            return React.createElement('section', { className: 'features', id: 'features' },
                React.createElement('div', { className: 'container' },
                    React.createElement('h2', null, 'Why Choose Istruzione F?'),
                    React.createElement('div', { className: 'features-grid' },
                        React.createElement('div', { className: 'feature-card' },
                            React.createElement('div', { className: 'feature-icon' }, 'ü§ñ'),
                            React.createElement('h3', null, 'Advanced Assistant'),
                            React.createElement('p', null, 'Tommy provides intelligent, contextual help with comprehensive platform knowledge')
                        ),
                        React.createElement('div', { className: 'feature-card' },
                            React.createElement('div', { className: 'feature-icon' }, 'üé®'),
                            React.createElement('h3', null, 'Beautiful Design'),
                            React.createElement('p', null, 'Clean, intuitive interfaces that make learning enjoyable and engaging')
                        ),
                        React.createElement('div', { className: 'feature-card' },
                            React.createElement('div', { className: 'feature-icon' }, 'üöÄ'),
                            React.createElement('h3', null, 'Lightning Fast'),
                            React.createElement('p', null, 'Instant responses and seamless performance across all your devices')
                        ),
                        React.createElement('div', { className: 'feature-card' },
                            React.createElement('div', { className: 'feature-icon' }, 'üìä'),
                            React.createElement('h3', null, 'Smart Analytics'),
                            React.createElement('p', null, 'Track progress with detailed insights and personalized recommendations')
                        )
                    )
                )
            );
        };

        const TommySection = () => {
            return React.createElement('section', { className: 'tommy-section', id: 'tommy' },
                React.createElement('div', { className: 'container' },
                    React.createElement('div', { className: 'tommy-content' },
                        React.createElement('div', { className: 'tommy-visual' },
                            React.createElement('div', { className: 'tommy-avatar' })
                        ),
                        React.createElement('div', { className: 'tommy-features' },
                            React.createElement('h2', null, 'Meet Tommy - Your Advanced Assistant'),
                            React.createElement('p', { style: { marginBottom: '2rem', color: 'var(--text-secondary)' } }, 
                                'Tommy is our sophisticated assistant with comprehensive knowledge of the Istruzione F platform. ' +
                                'He provides intelligent, contextual responses and personalized guidance for your learning journey.'
                            ),
                            React.createElement('div', { className: 'tommy-feature' },
                                React.createElement('div', { className: 'tommy-feature-icon' }, 'üí¨'),
                                React.createElement('div', null,
                                    React.createElement('h3', null, 'Context-Aware Responses'),
                                    React.createElement('p', null, 'Understands conversation context and provides relevant, personalized follow-ups')
                                )
                            ),
                            React.createElement('div', { className: 'tommy-feature' },
                                React.createElement('div', { className: 'tommy-feature-icon' }, 'üìö'),
                                React.createElement('div', null,
                                    React.createElement('h3', null, 'Comprehensive Knowledge'),
                                    React.createElement('p', null, 'Deep understanding of courses, pricing, platform features, and technical support')
                                )
                            ),
                            React.createElement('div', { className: 'tommy-feature' },
                                React.createElement('div', { className: 'tommy-feature-icon' }, 'üïí'),
                                React.createElement('div', null,
                                    React.createElement('h3', null, '24/7 Availability'),
                                    React.createElement('p', null, 'Always available to help with your learning journey, day or night')
                                )
                            )
                        )
                    )
                )
            );
        };

        // --- ü§ñ ADVANCED WIDGET (REBUILT) ---
        const AdvancedChatbotWidget = () => {
            const [isOpen, setIsOpen] = useState(false);
            const [isTyping, setIsTyping] = useState(false);
            const [inputValue, setInputValue] = useState('');
            
            // üß† 1. MEMORY STATE
            const [messages, setMessages] = useState([]);
            
            // üìù 4. LEAD GEN STATE
            const [isLeadMode, setIsLeadMode] = useState(false);
            
            // üó£Ô∏è 5. VOICE STATE
            const [voiceEnabled, setVoiceEnabled] = useState(false);

            const messagesEndRef = useRef(null);
            const textareaRef = useRef(null);

            // Load Memory on Mount
            useEffect(() => {
                const saved = localStorage.getItem('tommy_history');
                if (saved) {
                    setMessages(JSON.parse(saved));
                } else {
                    setMessages([{ 
                        text: "Hello! I'm **Tommy**. I remember our chats. Ask me about **features** or ask for a **human**.", 
                        isBot: true 
                    }]);
                }
            }, []);

            // Save Memory on Update
            useEffect(() => {
                if(messages.length > 0) {
                    localStorage.setItem('tommy_history', JSON.stringify(messages));
                }
                messagesEndRef.current?.scrollIntoView({ behavior: "smooth" });
            }, [messages]);

            // üó£Ô∏è VOICE FUNCTION
            const speak = (text) => {
                if (!voiceEnabled || !window.speechSynthesis) return;
                window.speechSynthesis.cancel(); // Stop previous
                // Remove markdown symbols for speech
                const cleanText = text.replace(/\*\*/g, '').replace(/‚Ä¢/g, ''); 
                const utterance = new SpeechSynthesisUtterance(cleanText);
                utterance.rate = 1.1;
                utterance.pitch = 1;
                window.speechSynthesis.speak(utterance);
            };

            // ‚ö° ACTION EXECUTOR
            const executeAction = (action) => {
                if (action === "SCROLL_FEATURES" || action === "SCROLL_PRICING") {
                    document.getElementById('features')?.scrollIntoView({ behavior: 'smooth' });
                }
                if (action === "ACTIVATE_LEAD_GEN") {
                    setIsLeadMode(true);
                }
                if (action === "CLEAR_MEMORY") {
                    localStorage.removeItem('tommy_history');
                    setMessages([{ text: "Memory wiped. Starting fresh!", isBot: true }]);
                }
            };

            // --- MAIN SEND FUNCTION (Updated to be Async) ---
            const handleSendMessage = async () => {
                if (!inputValue.trim() || isTyping) return;

                const userText = inputValue;
                setMessages(prev => [...prev, { text: userText, isBot: false }]);
                setInputValue('');
                setIsTyping(true);

                // Auto-resize textarea back
                if (textareaRef.current) {
                    textareaRef.current.style.height = 'auto';
                }

                // --- üìù LEAD GEN LOGIC (Local) ---
                if (isLeadMode) {
                    setTimeout(() => {
                        const result = tommyBrain.handleLeadCapture(userText);
                        const botMsg = { text: result.text, isBot: true };
                        setMessages(prev => [...prev, botMsg]);
                        speak(result.text);
                        setIsTyping(false);
                        if (result.success) setIsLeadMode(false);
                    }, 800);
                    return;
                }

                // --- üß† SERVER LOGIC (Async Fetch) ---
                try {
                    const response = await tommyBrain.generateResponse(userText);
                    
                    const botMsg = { text: response.text, isBot: true };
                    setMessages(prev => [...prev, botMsg]);
                    
                    setIsTyping(false);
                    speak(response.text);
                    if (response.action) executeAction(response.action);
                } catch (err) {
                    setIsTyping(false);
                    setMessages(prev => [...prev, { text: "Error contacting Tommy's brain.", isBot: true }]);
                }
            };

            const handleTextareaChange = (e) => {
                setInputValue(e.target.value);
                // Auto-resize
                if (textareaRef.current) {
                    textareaRef.current.style.height = 'auto';
                    textareaRef.current.style.height = Math.min(textareaRef.current.scrollHeight, 120) + 'px';
                }
            };

            const handleKeyPress = (e) => {
                if (e.key === 'Enter' && !e.shiftKey) {
                    e.preventDefault();
                    handleSendMessage();
                }
            };

            return React.createElement(React.Fragment, null,
                React.createElement('div', { 
                    className: 'chatbot-widget',
                    onClick: () => setIsOpen(true)
                },
                    React.createElement('div', { className: 'chatbot-icon' }, 'üí¨')
                ),
                React.createElement('div', { 
                    className: `chatbot-container ${isOpen ? 'active' : ''}` 
                },
                    // HEADER
                    React.createElement('div', { className: 'chatbot-header' },
                        React.createElement('div', { className: 'chatbot-avatar-small' }, 'T'),
                        React.createElement('div', { className: 'chatbot-info' },
                            React.createElement('h3', null, 'Tommy'),
                            React.createElement('p', null, 'Advanced Assistant')
                        ),
                        React.createElement('div', { className: 'header-actions' },
                            React.createElement('button', { 
                                className: `icon-btn ${voiceEnabled ? 'active' : ''}`, 
                                onClick: () => setVoiceEnabled(!voiceEnabled),
                                title: "Toggle Voice"
                            }, voiceEnabled ? 'üîä' : 'üîá'),
                            React.createElement('button', { 
                                className: 'icon-btn', 
                                onClick: () => { localStorage.removeItem('tommy_history'); setMessages([]); },
                                title: "Clear Chat"
                            }, 'üóëÔ∏è'),
                            React.createElement('button', { 
                                className: 'icon-btn', 
                                onClick: () => setIsOpen(false)
                            }, '√ó')
                        )
                    ),
                    // MESSAGES
                    React.createElement('div', { className: 'chatbot-messages' },
                        messages.map((message, index) =>
                            React.createElement('div', {
                                key: index,
                                className: `message ${message.isBot ? 'message-bot' : 'message-user'}`
                            }, React.createElement(MessageText, { text: message.text }))
                        ),
                        isTyping && React.createElement('div', { className: 'typing-indicator' },
                            React.createElement('div', { className: 'typing-dot' }),
                            React.createElement('div', { className: 'typing-dot' }),
                            React.createElement('div', { className: 'typing-dot' })
                        ),
                        React.createElement('div', { ref: messagesEndRef })
                    ),
                    // INPUT
                    React.createElement('div', { className: 'chatbot-input-container' },
                        React.createElement('div', { className: 'chatbot-input' },
                            React.createElement('textarea', {
                                ref: textareaRef,
                                className: isLeadMode ? "input-mode-lead" : "",
                                placeholder: isLeadMode ? "Enter phone number (e.g. 555-0199)..." : "Message Tommy...",
                                value: inputValue,
                                onChange: handleTextareaChange,
                                onKeyPress: handleKeyPress,
                                rows: 1
                            }),
                            React.createElement('button', { 
                                className: isLeadMode ? "btn-mode-lead" : "",
                                onClick: handleSendMessage,
                                disabled: !inputValue.trim() || isTyping
                            }, isLeadMode ? 'üìû' : '‚Üë')
                        )
                    )
                )
            );
        };

        const Footer = () => {
            return React.createElement('footer', { className: 'footer' },
                React.createElement('div', { className: 'container' },
                    React.createElement('p', null, 
                        '¬©Ô∏è 2024 Istruzione F. The future of learning starts here.'
                    )
                )
            );
        };

        const MainContent = () => {
            return React.createElement('div', { className: 'main-content' },
                React.createElement(Header),
                React.createElement(Hero),
                React.createElement(Features),
                React.createElement(TommySection),
                React.createElement(Footer)
            );
        };

        const App = () => {
            const [showSplash, setShowSplash] = useState(true);
            const [showContent, setShowContent] = useState(false);

            useEffect(() => {
                const timer = setTimeout(() => {
                    setShowSplash(false);
                    setTimeout(() => setShowContent(true), 500);
                }, 3000);

                return () => clearTimeout(timer);
            }, []);

            return React.createElement('div', { className: 'app' },
                showSplash && React.createElement(SplashScreen),
                showContent && React.createElement(MainContent),
                showContent && React.createElement(AdvancedChatbotWidget)
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(App));
    </script>
</body>
</html>